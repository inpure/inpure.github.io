---
title: Linux 文本管理，软链接和硬链接
tags: Linux inode
---
介绍节点表，软链接和硬链接
<!--more-->
## 1.节点索引

![inode表](/assets/image_Linux/inode表.png)  

* inode(index node)表中包含文件系统所有文件列表  
  在linux 同一个分区中每一个文件都有一个唯一的节点编号（inode number）  
* 查询节点编号：`ls -i`，查询当前目录节点编号：`ls -di`
* 一份分区分成两部分：1、节点表（inode table）,存放元数据；2、真正存放的数据(data content)。 节点表由**指针**指向存放的数据。
* 指针包括直接指针和间接指针，直接指针指向数据，间接指针指向指针地址。文件数据大就会用间接指针。
* 节点编号资源有限。查询分区可用节点编号数量：`df -i`
* **分区用光有两种情况：1、节点资源用光；2、存储空间用光**
* **删文件过程：实际上是删除目录文件里对映名字的目录项，释放节点号，但是数据还在磁盘**

## 2.硬链接

对一个文件，起多个文件名，指向同一个节点编号，本质上是同一个文件

* 创建方法：`ln f1 ff1  ：为f1 文件创建一个 ff1 的硬链接`
  * 相对路径创建是相对当前路径，与软连接不同
* 硬链接可以跨目录，不能跨分区
* 硬连接创建不支持目录，只支持文件
* 链接数：同一个文件的文件名数
  * 每个目录的硬链接数至少是2，因为有符号链接`.`
  * 查看硬链接数：`ll -i`  文件所属用户名前面一项就是
* 删除原始文件，硬连接依旧可以访问。因为本质上原始文件和硬连接是平级的
* 查找一个文件的所有硬连接，先找到文件的节点编号：`find -inum 节点编号`
* 硬连接文件大小就是文件数据大小，和原始文件一下
* 不支持目录
  
## 3.软链接

本质上是一个指针，指向的是文件名，软连接本身是一个新文件

* 创建方法：`ln -s f1 ff1 : 为f1 创建一个 ff1 的软连接`
* 可用于目录，可跨分区，比硬连接应用更广泛
* 原始文件路径一般用相对路径，相对路径一定是**相对于软连接文件的路径**
  * 例：`ln -s ../data/dir1/f1  /root/f1link`  
    在/root 目录下创建一个 /data/dir1/f1 文件的软链接
* 删除原始文件，软链接无法访问
* 软连接文件大小是指指向路径的大小，和原始文件不同
* 支持目录

## **4.软硬连接区别：**  

  1. 硬链接是同一个文件，软连接不是
  2. 硬链接不能跨分区，软链接可以
  3. 硬连接增长链接数，软链接不变
  4. 硬链接节点编号相同，软连接不同
  5. 删除原始文件，硬连接可访问，软连接不可访问
  6. 硬连接大小是文件数据的大小，软连接大小是指向路径的大小
  7. 硬链接不支持目录，软连接支持
  8. 相对路径写法不一样